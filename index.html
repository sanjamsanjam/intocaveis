<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Intoc√°veis FC ‚öΩ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { margin:0; font-family:Arial; background:#f1f5f9 }
header { background:#0f172a; color:white; padding:15px }
nav button {
  margin:5px; padding:8px 12px;
  border:none; border-radius:6px;
  background:#22c55e; color:white;
  cursor:pointer
}
section { display:none; padding:20px }
.card {
  background:white; padding:15px;
  border-radius:10px; margin-bottom:20px
}
.player {
  display:inline-block; width:160px;
  margin:10px; background:white;
  border-radius:10px; padding:10px;
  text-align:center
}
.player img {
  width:100%; height:120px;
  object-fit:cover; border-radius:8px
}
input { padding:6px; margin:4px; width:95% }
</style>
</head>

<body>

<header>
<h2>‚öΩ Intoc√°veis FC</h2>
<nav>
<button onclick="showJogadores()">Jogadores</button>
</nav>
</header>

<section id="jogadores">
<div class="card">
<h3>Cadastrar Jogador</h3>
<input id="nome" placeholder="Nome">
<input id="posicao" placeholder="Posi√ß√£o">
<input id="foto" type="file">
<button onclick="salvarJogador()">Salvar</button>
</div>

<div id="lista"></div>
</section>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
// üîë SUBSTITUA SOMENTE ESTES DOIS VALORES
const SUPABASE_URL = "https://rbnwmnacjjlzwvgdhknf.supabase.co";
const SUPABASE_KEY = "SUA_PUBLISHABLE_KEY_AQUI";

// ‚úÖ DECLARADO UMA √öNICA VEZ
const supabaseClient = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_KEY
);

const FOTO_PADRAO = "https://via.placeholder.com/150";

// ‚úÖ FUN√á√ÉO DO BOT√ÉO
function showJogadores(){
  document.getElementById("jogadores").style.display = "block";
}

// ‚úÖ CARREGAR JOGADORES
async function carregarJogadores(){
  const { data, error } = await supabaseClient
    .from("jogadores")
    .select("*")
    .order("id");

  if(error){
    console.error(error);
    alert("Erro ao carregar jogadores");
    return;
  }

  lista.innerHTML = "";
  data.forEach(j => {
    lista.innerHTML += `
      <div class="player">
        <img src="${j.foto || FOTO_PADRAO}">
        <b>${j.nome}</b>
        <p>${j.posicao}</p>
      </div>
    `;
  });
}

// ‚úÖ SALVAR JOGADOR
async function salvarJogador(){
  if(!nome.value || !posicao.value){
    alert("Preencha nome e posi√ß√£o");
    return;
  }

  const inserir = async (fotoUrl) => {
    const { error } = await supabaseClient
      .from("jogadores")
      .insert({
        nome: nome.value,
        posicao: posicao.value,
        foto: fotoUrl
      });

    if(error){
      console.error(error);
      alert("Erro ao salvar jogador");
      return;
    }

    nome.value = "";
    posicao.value = "";
    foto.value = "";
    carregarJogadores();
  };

  if(foto.files[0]){
    const reader = new FileReader();
    reader.onload = () => inserir(reader.result);
    reader.readAsDataURL(foto.files[0]);
  } else {
    inserir(FOTO_PADRAO);
  }
}

// ‚úÖ INICIALIZA
showJogadores();
carregarJogadores();
</script>

</body>
</html>
